<import src="../../components/loading/index.wxml" />
<scroll-view scroll-y="true" class="container {{ iPhonex ? 'pd-x' : 'pd-un'}}" bindscrolltolower="onReachBottom">
    <!-- 店铺信息 -->
    <view class="store-container flex-box flex-a-center bg-white">
        <image class="store-img" src="{{storeInfo.head_img}}"></image>
        <view class="store-info">
            <view class="store-name color-51 font-lg">{{storeInfo.store_name}}</view>
            <view class="product-sign sign-color font-sm store-is-auth">{{storeInfo.is_authorization == 2 ? '已认证' : '未认证'}}</view>
        </view>
    </view>
    <!-- 产品列表 -->
    <view class="product-container">
        <!-- 筛选条件 -->
        <view class="filter-container flex-box flex-a-center flex-j-between">
            <view class="filter-left flex-box flex-a-center">
                <view class="filter-item flex-box flex-a-center font-md shallow-color {{item.id == filterId ? 'font-weight color-51' : ''}}" wx:for="{{filterList}}" wx:key="index" data-id="{{item.id}}" bindtap="switchFilterItem">
                    <view>{{item.name}}</view>
                    <image class="price-sort" wx:if="{{item.id == 4}}" src="{{priceSort ? priceSort == 1 ? item.top : item.bottom : item.normal}}"></image>
                </view>
            </view>
            <!-- <view class="filter-right">
                <van-checkbox
                value="{{ allianceBond }}"
                checked-color="rgb(252, 132, 57)"
                bind:change="isHasBond"
              >
              <text class="font-md">含联盟券</text>
              </van-checkbox>
            </view> -->
        </view>
        <!-- 产品列表 -->
        <view wx:if="{{productList.length}}" class="product-list">
            <view class="product-item bg-white flex-box flex-a-center" wx:for="{{productList}}" wx:key="index" data-id="{{item.product_id}}" bindtap="goDetail">
                <image src="" class="product-img flex-shrink" src="{{item.head_img_name[0] + '?imageMogr2/thumbnail/400x400'}}"></image>
                <view class="product-info">
                    <view class="product-tittle flex-box flex-a-center">
                        <!-- <view wx:if="{{item.is_auth == 1}}" class="product-sign sign-color font-sm flex-shrink inline-block">{{item.is_auth == 1 ? '已认证' : '未认证'}}</view> -->
                        <view class="product-name two-line color-51 font-md"><view wx:if="{{item.is_auth == 1}}" class="product-sign sign-color font-sm flex-shrink inline-block">{{item.is_auth == 1 ? '已认证' : '未认证'}}</view>{{item.title}}</view>
                    </view>
                    <view class="product-price color-102 font-sm flex-box flex-a-center flex-j-between">
                            <view class="price color-102 font-sm">
                                <text>￥{{item.has_coupon == 1 ? item.discount_price_float : item.min_price_float}}</text>
                                <text wx:if="{{item.has_coupon == 1}}" class="line-through font-base color-153">￥{{item.min_price_float}}</text>
                            </view>
                            <view wx:if="{{item.has_coupon == 1}}" class="product-sign sign-color font-sm">券减{{item.dis_sub_price}}</view>
                        </view>
                    <view class="product-sale flex-box flex-a-center flex-j-between">
                        <view class="product-intro font-sm color-153 one-line">{{item.shop_name}}</view>
                        <view class="product-sale-num font-sm color-153">销量   {{item.total_sold_num}}</view>
                    </view>
                    <view class="product-action flex-box flex-a-center flex-j-between">
                        <view class="product-commission base-color font-lg font-weight"><text class="symbol font-sm">赚</text>￥{{item.commission_value_total}}</view>
                        <view class="product-btn color-white" catchtap="commerceOnToggle" data-id="{{item.product_id}}">带货</view>
                    </view>
                    <view wx:if="{{item.is_sample_free == 1}}" class="product-commission-rule flex-box flex-a-center">
                        <view class="sign-color font-sm">{{item.sell_order_num > 0 ? '推客销量≥' + item.sell_order_num + '可免费领样' : '免费领样'}}</view>
                        <image src="https://qizhifan.oss-cn-hangzhou.aliyuncs.com/wechat/images/20220602/a1fcf9ccccdb4e5f09d3fd49bc363de2.png" class="product_rule_img"></image>
                    </view>
                </view>
            </view>
        </view>
        <view wx:if="{{!productList.length && isLast}}" class="text-center font-sm shallow-color no-data">
            <no-data text="暂无数据~" cover="https://qizhifan.oss-cn-hangzhou.aliyuncs.com/wechat/images/20220621/2475527f5c59a3afdb619229c73b84d9.png"></no-data>
        </view>
        <view hidden="{{isLast}}">
            <template is="loader" data="{{title:'加载中...'}}"></template>
        </view>
    </view>
</scroll-view>
<!-- 带货弹层 -->
<van-action-sheet
    show="{{ showSheet }}"
    actions="{{ sheetAction }}"
    description="请选择小商店或视频号"
    cancel-text="取消"
    bind:close="commerceOnToggle"
    bind:select="commerceOnSelect"
/>

